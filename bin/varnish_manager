#!/usr/bin/python

from varnish import VarnishManager, VarnishServer
from pprint import pprint

in_data = raw_input('Varnish Management Address (secret@ip:port): ').split('@')
addr = in_data[1]
secret = in_data[0]
#server = VarnishServer(addr, secret)
server = VarnishServer(*in_data)
#manager = VarnishManager((raw_input('Varnish Management Address (secret@ip:port): '),))
manager = VarnishManager((server,))

while 1:
    try:
        i = raw_input('varnish> ')
    except (EOFError, KeyboardInterrupt):
        break
    if i.startswith('quit') or i.startswith('exit'):
        break
    pprint(manager.run(*i.split()))

manager.close()
